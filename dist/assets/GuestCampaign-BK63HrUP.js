import{r as u,j as t,B as w,_ as i,N as C,O as v,y,I as S,P as b}from"./index-BmEbPKAO.js";import{A as _,a as I,b as N,c as D,e as V}from"./alert-dialog-DpCus9NV.js";import{I as E}from"./input-DLkXYEKk.js";import{C as g}from"./Card-DErCIlZE.js";import{C as T}from"./CampaignTable-CyYP_AS2.js";import"./index-DOuoiFe8.js";import"./Combination-BpHwYojT.js";import"./component-ClC3MksJ.js";import"./table-CEDGsAWc.js";import"./index-DrNK3aqy.js";import"./index-DdATkUqs.js";function $({modalActive:m,setModalActive:n,setCampaigns:x,campaign_id:c}){const[e,l]=u.useState(!1),h=async d=>{l(!0),d.preventDefault();const j=d.target,o=Object.fromEntries(new FormData(j)).access_code,r=i.loading("Verifying access code...");await C.get(`${v}/dashboard/${c}/${o}`).then(s=>{i.success("Access code verified",{id:r}),x(s.data),sessionStorage.setItem("guestVerified","true"),sessionStorage.setItem("access_code",JSON.stringify(o)),n(!1)}).catch(s=>{if(s.response.status&&s.response.status===401)return i.error("Access denied. Access code invalid",{id:r});i.error("Something went wrong",{id:r}),console.log(s)}).finally(()=>l(!1))};return t.jsx(_,{open:m,children:t.jsxs(I,{className:"max-w-lg",children:[t.jsx(N,{children:t.jsx(D,{className:"text-xl font-semibold",children:"Enter Access Code"})}),t.jsx(V,{children:"An access code was sent with the invite mail. Enter it to gain access to view this campaign"}),t.jsxs("form",{onSubmit:h,className:"flex items-center gap-2",children:[t.jsx(E,{type:"text",placeholder:"access code",name:"access_code",required:!0}),t.jsx(w,{type:"submit",className:"pry-btn",disabled:e,children:"View Campaign"})]})]})})}function H(){var p,A;const m=sessionStorage.getItem("guestVerified"),{campaign_id:n}=y(),[x,c]=u.useState(()=>!m),[e,l]=u.useState([]),[h,d]=u.useState(!1),j=async()=>{d(!0);const a=sessionStorage.getItem("access_code");if(!a)return c(!0);await C.get(`${v}/dashboard/${n}/${JSON.parse(a)}`).then(f=>{l(f.data),sessionStorage.setItem("guestVerified","true")}).catch(f=>{if(c(!0),f.response.status&&f.response.status===401)return i.error("Access denied. Access code invalid");i.error("Something went wrong")}).finally(()=>{d(!1)})};u.useEffect(()=>{sessionStorage.getItem("guestVerified")&&j()},[]);const o=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(a=>a.status.toLowerCase()==="contacted")),r=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(a=>a.contacted_status.toLowerCase()==="converted")),s=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(a=>a.contacted_status.toLowerCase()==="answered"||a.contacted_status.toLowerCase()==="converted"));return t.jsxs(t.Fragment,{children:[t.jsx($,{modalActive:x,setModalActive:c,setCampaigns:l,campaign_id:n}),t.jsxs("div",{className:"px-[4vw] pb-10",children:[t.jsx(S,{}),h?t.jsx(b,{}):(e==null?void 0:e.leads)&&t.jsxs("div",{className:"mt-10",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[t.jsx(g,{title:"Total Leads",qty:((p=e==null?void 0:e.leads)==null?void 0:p.length)||0}),t.jsx(g,{title:"Total Called",qty:(o==null?void 0:o.length)||0,total:((A=e==null?void 0:e.leads)==null?void 0:A.length)||0}),t.jsx(g,{title:"Total Answered",qty:(s==null?void 0:s.length)||0,total:(o==null?void 0:o.length)||0}),t.jsx(g,{title:"Total Qualified",qty:(r==null?void 0:r.length)||0,total:(s==null?void 0:s.length)||0})]}),t.jsx("div",{className:"p-4 rounded-2xl bg-white",children:t.jsx(T,{guest:!0,campaign_id:n??"",data:e==null?void 0:e.leads,campaign_name:e==null?void 0:e.campaign_name})})]})]})]})}export{H as default};
