import{r as u,j as t,B as w,_ as i,N as C,O as v,y as S,I as y,S as b}from"./index-e-UFtOUC.js";import{A as _,a as I,b as N,c as D,d as V}from"./alert-dialog-CEOMNaNZ.js";import{I as E}from"./input-DxTUsu_w.js";import{C as f}from"./Card-DK7yle0L.js";import{C as T}from"./CampaignTable-BgmH1JrZ.js";import"./index-CJ8OMbQp.js";import"./Combination-BgG73cBh.js";import"./index-ciowWXAl.js";import"./table-CQZEcfDi.js";import"./createLucideIcon-ljYiYlmp.js";import"./popover-qKfd6OnR.js";import"./floating-ui.react-dom-YN4Fy7vO.js";import"./select-tKmmqQ5T.js";import"./index-CsvDA1G3.js";import"./index-CWBMpTRi.js";function $({modalActive:g,setModalActive:n,setCampaigns:x,campaign_id:c}){const[e,l]=u.useState(!1),h=async d=>{l(!0),d.preventDefault();const p=d.target,o=Object.fromEntries(new FormData(p)).access_code,a=i.loading("Verifying access code...");await C.get(`${v}/dashboard/${c}/${o}`).then(s=>{i.success("Access code verified",{id:a}),x(s.data),sessionStorage.setItem("guestVerified","true"),sessionStorage.setItem("access_code",JSON.stringify(o)),n(!1)}).catch(s=>{if(s.response.status&&s.response.status===401)return i.error("Access denied. Access code invalid",{id:a});i.error("Something went wrong",{id:a}),console.log(s)}).finally(()=>l(!1))};return t.jsx(_,{open:g,children:t.jsxs(I,{className:"max-w-lg",children:[t.jsx(N,{children:t.jsx(D,{className:"text-xl font-semibold",children:"Enter Access Code"})}),t.jsx(V,{children:"An access code was sent with the invite mail. Enter it to gain access to view this campaign"}),t.jsxs("form",{onSubmit:h,className:"flex items-center gap-2",children:[t.jsx(E,{type:"text",placeholder:"access code",name:"access_code",required:!0}),t.jsx(w,{type:"submit",className:"pry-btn",disabled:e,children:"View Campaign"})]})]})})}function K(){var j,A;const g=sessionStorage.getItem("guestVerified"),{campaign_id:n}=S(),[x,c]=u.useState(()=>!g),[e,l]=u.useState([]),[h,d]=u.useState(!1),p=async()=>{d(!0);const r=sessionStorage.getItem("access_code");if(!r)return c(!0);await C.get(`${v}/dashboard/${n}/${JSON.parse(r)}`).then(m=>{l(m.data),sessionStorage.setItem("guestVerified","true")}).catch(m=>{if(c(!0),m.response.status&&m.response.status===401)return i.error("Access denied. Access code invalid");i.error("Something went wrong")}).finally(()=>{d(!1)})};u.useEffect(()=>{sessionStorage.getItem("guestVerified")&&p()},[]);const o=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(r=>r.status.toLowerCase()==="contacted")),a=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(r=>r.contacted_status.toLowerCase()==="converted")),s=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(r=>r.contacted_status.toLowerCase()==="answered"||r.contacted_status.toLowerCase()==="converted"));return t.jsxs(t.Fragment,{children:[t.jsx($,{modalActive:x,setModalActive:c,setCampaigns:l,campaign_id:n}),t.jsxs("div",{className:"px-[4vw] pb-10",children:[t.jsx(y,{}),h?t.jsx(b,{}):(e==null?void 0:e.leads)&&t.jsxs("div",{className:"mt-10",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[t.jsx(f,{title:"Total Leads",qty:((j=e==null?void 0:e.leads)==null?void 0:j.length)||0}),t.jsx(f,{title:"Total Called",qty:(o==null?void 0:o.length)||0,total:((A=e==null?void 0:e.leads)==null?void 0:A.length)||0}),t.jsx(f,{title:"Total Answered",qty:(s==null?void 0:s.length)||0,total:(o==null?void 0:o.length)||0}),t.jsx(f,{title:"Total Qualified",qty:(a==null?void 0:a.length)||0,total:(s==null?void 0:s.length)||0})]}),t.jsx("div",{className:"p-4 rounded-2xl bg-white",children:t.jsx(T,{guest:!0,campaign_id:n??"",data:e==null?void 0:e.leads,campaign_name:e==null?void 0:e.campaign_name})})]})]})]})}export{K as default};
