import{a as n,b as i}from"./baseUrl-HwsEoYQ5.js";import{_ as a}from"./index-BamLPRPK.js";const f=async(r,t,o)=>{const s=a.loading("Creating your account");t(!0),await n.post(`${i}/api/register/`,r).then(e=>{localStorage.getItem("newUser")&&localStorage.removeItem("newUser"),localStorage.setItem("newUser",JSON.stringify(e.data)),a.success("Account creation successful",{id:s}),o("/auth/verify-otp")}).catch(e=>{e.response.data.email?a.error(`Account creation failed. ${e.response.data.email[0]}`,{id:s}):e.response.data.phone_number?a.error(`Account creation failed. ${e.response.data.phone_number[0]}`,{id:s}):e.response.data.last_name?a.error("Account creation failed. Please enter a full name",{id:s}):a.error("Something went wrong. Please retry",{id:s}),console.log(e)}).finally(()=>{t(!1)})},g=async(r,t,o)=>{t(!0);const s=a.loading("Signing In...");await n.post(`${i}/api/token/`,r).then(e=>{const c={access:e.data.access,refresh:e.data.refresh};localStorage.setItem("tokens",JSON.stringify(c)),localStorage.setItem("user",JSON.stringify(e.data.user.id)),localStorage.setItem("business_id",JSON.stringify(e.data.user.businesses[0].id)),a.success("Login Successful",{id:s}),o("/app/dashboard")}).catch(e=>{e.response.data.non_field_errors?a.error(`Sign in failed. ${e.response.data.non_field_errors[0]}`,{id:s}):a.error("Something went wrong. Please retry",{id:s})}).finally(()=>{t(!1)})},u=async(r,t)=>{const o=a.loading("Verifying OTP...");await n({url:`${i}/api/activate/`,method:"post",data:r}).then(()=>{a.success("OTP verification successful. Please Sign in",{id:o}),localStorage.removeItem("newUser"),t("/auth")}).catch(s=>{a.error("Please check the OTP and retry",{id:o}),console.log(s)})};export{u as O,g as l,f as r};
