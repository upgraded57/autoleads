import{r as g,j as t,_ as i,e as A}from"./index-BTCpIiPF.js";import{L as C}from"./Logo-BQp2vZ12.js";import{a as p,b as j}from"./baseUrl-HwsEoYQ5.js";import{A as w,a as b,b as v,c as y,e as S}from"./alert-dialog-gQRSNSLl.js";import{B as _}from"./button-CJVJc3-c.js";import{I}from"./input-CJ-424JH.js";import{C as f}from"./Card-BU0hKaaM.js";import{C as N}from"./CampaignTable-iCrf4jf3.js";import"./logo-alt-DamHNGlx.js";import"./index-CJdAoNCs.js";import"./Combination-CQp_1Ujl.js";import"./table-BB3I57W9.js";import"./index-zjZIvZCD.js";import"./iconBase-YLiFKhbO.js";import"./index-Blzf-GOL.js";import"./axiosInstance-D6jcOrH_.js";function D({modalActive:x,setModalActive:c,setCampaigns:m,campaign_id:n}){const[e,d]=g.useState(!1),h=async o=>{d(!0),o.preventDefault();const l=o.target,r=Object.fromEntries(new FormData(l)).access_code,a=i.loading("Verifying access code...");await p.get(`${j}/dashboard/${n}/${r}`).then(s=>{i.success("Access code verified",{id:a}),m(s.data),sessionStorage.setItem("guestVerified","true"),sessionStorage.setItem("access_code",JSON.stringify(r)),c(!1)}).catch(s=>{if(s.response.status&&s.response.status===401)return i.error("Access denied. Access code invalid",{id:a});i.error("Something went wrong",{id:a}),console.log(s)}).finally(()=>d(!1))};return t.jsx(w,{open:x,children:t.jsxs(b,{className:"max-w-lg",children:[t.jsx(v,{children:t.jsx(y,{className:"text-xl font-semibold",children:"Enter Access Code"})}),t.jsx(S,{children:"An access code was sent with the invite mail. Enter it to gain access to view this campaign"}),t.jsxs("form",{onSubmit:h,className:"flex items-center gap-2",children:[t.jsx(I,{type:"text",placeholder:"access code",name:"access_code",required:!0}),t.jsx(_,{type:"submit",className:"pry-btn",disabled:e,children:"View Campaign"})]})]})})}function U(){var a;const x=sessionStorage.getItem("guestVerified"),{campaign_id:c}=A(),[m,n]=g.useState(()=>!x),[e,d]=g.useState([]),h=async()=>{const s=sessionStorage.getItem("access_code");if(!s)return n(!0);await p.get(`${j}/dashboard/${c}/${JSON.parse(s)}`).then(u=>{d(u.data),sessionStorage.setItem("guestVerified","true")}).catch(u=>{if(n(!0),u.response.status&&u.response.status===401)return i.error("Access denied. Access code invalid");i.error("Something went wrong")})};g.useEffect(()=>{sessionStorage.getItem("guestVerified")&&h()},[]);const o=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(s=>s.status.toLowerCase()==="contacted")),l=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(s=>s.contacted_status.toLowerCase()==="converted")),r=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(s=>s.contacted_status.toLowerCase()==="rejected"));return t.jsxs(t.Fragment,{children:[m&&t.jsx(D,{modalActive:m,setModalActive:n,setCampaigns:d,campaign_id:c}),t.jsx(C,{}),(e==null?void 0:e.leads)&&t.jsxs("div",{className:"px-5",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[t.jsx(f,{title:"Total Leads",qty:((a=e==null?void 0:e.leads)==null?void 0:a.length)||0}),t.jsx(f,{title:"Total Called",qty:(o==null?void 0:o.length)||0}),t.jsx(f,{title:"Total Qualified",qty:(l==null?void 0:l.length)||0}),t.jsx(f,{title:"Total Rejected",qty:(r==null?void 0:r.length)||0})]}),t.jsx("div",{className:"p-4 rounded-2xl bg-white",children:t.jsx(N,{campaign_id:c??"",data:e==null?void 0:e.leads,campaign_name:e==null?void 0:e.campaign_name})})]})]})}export{U as default};
