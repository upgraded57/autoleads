import{i as T,r as b,m as P,f as z,n as R,j as e,B as a,h as I,o as E,_ as h,p as F,q as _,l as M,L as S,e as H,E as V}from"./index-Dwu-iOUK.js";import{F as Y}from"./index-lVw45tfr.js";import{T as O,a as U,b as k,c as n,d as q,e as r}from"./table-AHFrzMlA.js";import{A as B,a as Q,b as $,c as G,d as J,e as K,f as W,g as X}from"./alert-dialog-Bomi9S7Q.js";import{I as Z}from"./input-D62eCxPF.js";import{P as ee,a as se,H as te,b as A}from"./popover-DlS30aSR.js";import{c as ae,a as ie}from"./Codes-Aocz_J8q.js";import{L as le}from"./loader-circle-sHEuQ9bA.js";import"./index-CkvznDmw.js";import"./Combination-BdCjAoXq.js";import"./index-qguIVRpM.js";import"./floating-ui.react-dom-BaUnj6py.js";import"./createLucideIcon-CS6NP1Wv.js";function ne({data:l}){const[t,f]=T({type:"",value:""}),[y,x]=b.useState(!1),[u,p]=b.useState(""),N=P(),m=z(),[o,j]=b.useState(l),C=(s,i)=>{const w={...Object.fromEntries(t.entries()),[s]:i};f(w)};b.useEffect(()=>{(()=>{const i=t.get("type"),c=t.get("value");if(!i&&!c){j(l);return}const w=l==null?void 0:l.filter(g=>{if(!i&&c)return g.title.toLowerCase().includes(c.toLowerCase());if(!c&&i)return i.toLowerCase()===g.type_of.toLowerCase();if(c&&i)return i.toLowerCase()===g.type_of.toLowerCase()&&g.title.toLowerCase().includes(c.toLowerCase())});j(w)})()},[t,l]);const d=s=>{m(`/app/campaigns/${s}`)},{mutateAsync:L,isPending:v}=R(),D=s=>{const i=h.loading("Deleting Campaign");L(s).then(()=>{h.success("Campaign deleted successfully",{id:i}),N.invalidateQueries()}).catch(()=>{h.error("Unable to delete campaign",{id:i})})};return e.jsxs("div",{children:[e.jsxs("div",{className:"w-full flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"basis-1/4 flex items-center gap-2",children:[e.jsx("p",{className:"",children:"Filter by:"}),e.jsx(a,{variant:"outline",className:"p-0 h-auto",children:e.jsxs("select",{className:"bg-transparent outline-hidden h-10 px-2",onChange:s=>C("type",s.target.value),defaultValue:t.get("type")??"",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"direct",children:"Direct"}),e.jsx("option",{value:"upload",children:"Upload"})]})})]}),e.jsx(Z,{type:"text",placeholder:"Search by campaign title...",className:"max-w-[300px]",defaultValue:t.get("value")||"",onChange:s=>C("value",s.target.value)}),e.jsx("div",{className:"basis-1/4 flex items-center justify-end gap-2"})]}),e.jsxs(O,{children:[e.jsx(U,{children:e.jsxs(k,{children:[e.jsx(n,{children:"ID"}),e.jsx(n,{children:"Title"}),e.jsx(n,{children:"Leads"}),e.jsx(n,{children:"Created At"}),e.jsx(n,{children:"Type"}),e.jsx(n,{children:"Contacted"}),e.jsx(n,{children:"Converted"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(q,{children:o==null?void 0:o.map(s=>e.jsxs(k,{children:[e.jsx(r,{onClick:()=>d(s.id),children:s.id}),e.jsx(r,{onClick:()=>d(s.id),children:s.title}),e.jsx(r,{onClick:()=>d(s.id),children:s.leads}),e.jsx(r,{onClick:()=>d(s.id),children:I(s.created).format("MMM DD, YYYY hh:mm")}),e.jsx(r,{onClick:()=>d(s.id),children:s.type_of}),e.jsx(r,{onClick:()=>d(s.id),children:s.contacted_leads}),e.jsx(r,{onClick:()=>d(s.id),children:s.converted_leads}),e.jsx(r,{children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsx(a,{size:"sm",variant:"ghost",className:"my-2",children:e.jsx(te,{})})}),s.type_of.toLowerCase()==="upload"?e.jsxs(A,{className:"flex flex-col gap-3 w-max",children:[e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>E(s.id),children:"Launch Campaign"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded border-destructive text-destructive hover:bg-destructive hover:text-white",disabled:v,onClick:()=>{p(s.id),x(!0)},children:"Reset Campaign"}),e.jsx(a,{variant:"destructive",size:"sm",className:"rounded",disabled:v,onClick:()=>D(s.id),children:"Delete Campaign"})," "]}):e.jsxs(A,{className:"flex flex-col gap-3 w-max",children:[e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>ae(s.id),children:"Copy code as popup"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>ie(s.id),children:"Copy code inline form"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>{m(`/campaigns/form/edit/${s.id}`)},children:"Edit Form"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>{m(`/campaigns/edit/${s.id}`)},children:"Edit Context"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded border-destructive text-destructive hover:bg-destructive hover:text-white",disabled:v,onClick:()=>{p(s.id),x(!0)},children:"Reset Campaign"}),e.jsx(a,{variant:"destructive",size:"sm",className:"rounded",disabled:v,onClick:()=>D(s.id),children:"Delete Campaign"})]})]})})]},s.id))})]}),e.jsx(re,{open:y,setIsOpen:x,id:u,setCurrentId:p})]})}const re=({open:l,setIsOpen:t,id:f,setCurrentId:y})=>{const{mutateAsync:x,isPending:u}=F(),p=N=>{if(N.preventDefault(),!f)return;const m=h.loading("Resetting campaign data",{id:"resetToast"});x(f).then(()=>{h.success("Campaign data reset successfully",{id:m})}).catch(o=>{var j,C;h.error(((C=(j=o==null?void 0:o.response)==null?void 0:j.data)==null?void 0:C.message)||"Unable to reset campaign data",{id:m})})};return e.jsx(B,{open:l,onOpenChange:u?()=>{}:()=>{t(!1),y("")},children:e.jsxs(Q,{children:[e.jsxs($,{children:[e.jsx(G,{children:"Reset Campaign?"}),e.jsx(J,{className:"py-4",children:"This action cannot be undone. This will permanently delete all the leads in the campaign. Do you still wish to proceed?"})]}),e.jsxs(K,{children:[e.jsxs(W,{className:"mr-2 bg-destructive text-white hover:bg-destructive/90",onClick:p,disabled:u,children:[u&&e.jsx(le,{className:"animate-spin"}),"Yes, Reset Campaign"]}),e.jsx(X,{disabled:u,children:"No, Cancel"})]})]})})};function be(){const{isLoading:l,data:t}=_();return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Campaigns",subtitle:"All your campaigns in one place",button:e.jsx(S,{to:"/campaigns/new",children:e.jsxs(a,{className:"pry-btn gap-1",children:[e.jsx(Y,{})," Add New Campaign"]})})}),e.jsx("div",{className:"p-4 rounded-2xl bg-white",children:l?e.jsx("div",{className:"w-full h-[300px] flex items-center justify-center",children:e.jsx(H,{})}):(t==null?void 0:t.length)>0?e.jsx(ne,{data:t}):e.jsx(V,{})})]})}export{be as default};
