import{r as u,j as s,B as C,_ as i,V as w,W as A,z as v,J as S,X as b}from"./index-Bb1ApEie.js";import{A as y,a as _,b as I,c as N,e as D}from"./alert-dialog-B-LHCmkD.js";import{I as V}from"./input-Bog5ZDZ-.js";import{C as m}from"./Card-DVZBKseZ.js";import{C as L}from"./CampaignTable-FK8r4OAs.js";import"./index-Dgoz4d5O.js";import"./Combination-B2ugSinr.js";import"./table-CGKNm2le.js";import"./index-uQzmq7xo.js";function E({modalActive:g,setModalActive:n,setCampaigns:x,campaign_id:c}){const[e,d]=u.useState(!1),h=async l=>{d(!0),l.preventDefault();const j=l.target,r=Object.fromEntries(new FormData(j)).access_code,o=i.loading("Verifying access code...");await w.get(`${A}/dashboard/${c}/${r}`).then(t=>{i.success("Access code verified",{id:o}),x(t.data),sessionStorage.setItem("guestVerified","true"),sessionStorage.setItem("access_code",JSON.stringify(r)),n(!1)}).catch(t=>{if(t.response.status&&t.response.status===401)return i.error("Access denied. Access code invalid",{id:o});i.error("Something went wrong",{id:o}),console.log(t)}).finally(()=>d(!1))};return s.jsx(y,{open:g,children:s.jsxs(_,{className:"max-w-lg",children:[s.jsx(I,{children:s.jsx(N,{className:"text-xl font-semibold",children:"Enter Access Code"})}),s.jsx(D,{children:"An access code was sent with the invite mail. Enter it to gain access to view this campaign"}),s.jsxs("form",{onSubmit:h,className:"flex items-center gap-2",children:[s.jsx(V,{type:"text",placeholder:"access code",name:"access_code",required:!0}),s.jsx(C,{type:"submit",className:"pry-btn",disabled:e,children:"View Campaign"})]})]})})}function M(){var p;const g=sessionStorage.getItem("guestVerified"),{campaign_id:n}=v(),[x,c]=u.useState(()=>!g),[e,d]=u.useState([]),[h,l]=u.useState(!1),j=async()=>{l(!0);const a=sessionStorage.getItem("access_code");if(!a)return c(!0);await w.get(`${A}/dashboard/${n}/${JSON.parse(a)}`).then(f=>{d(f.data),sessionStorage.setItem("guestVerified","true")}).catch(f=>{if(c(!0),f.response.status&&f.response.status===401)return i.error("Access denied. Access code invalid");i.error("Something went wrong")}).finally(()=>{l(!1)})};u.useEffect(()=>{sessionStorage.getItem("guestVerified")&&j()},[]);const r=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(a=>a.status.toLowerCase()==="contacted")),o=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(a=>a.contacted_status.toLowerCase()==="converted")),t=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(a=>a.contacted_status.toLowerCase()==="rejected"));return s.jsxs(s.Fragment,{children:[s.jsx(E,{modalActive:x,setModalActive:c,setCampaigns:d,campaign_id:n}),s.jsxs("div",{className:"px-[4vw] pb-10",children:[s.jsx(S,{}),h?s.jsx(b,{}):(e==null?void 0:e.leads)&&s.jsxs("div",{className:"mt-10",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[s.jsx(m,{title:"Total Leads",qty:((p=e==null?void 0:e.leads)==null?void 0:p.length)||0}),s.jsx(m,{title:"Total Called",qty:(r==null?void 0:r.length)||0}),s.jsx(m,{title:"Total Qualified",qty:(o==null?void 0:o.length)||0}),s.jsx(m,{title:"Total Rejected",qty:(t==null?void 0:t.length)||0})]}),s.jsx("div",{className:"p-4 rounded-2xl bg-white",children:s.jsx(L,{guest:!0,campaign_id:n??"",data:e==null?void 0:e.leads,campaign_name:e==null?void 0:e.campaign_name})})]})]})]})}export{M as default};
