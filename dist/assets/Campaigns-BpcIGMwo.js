import{i as z,r as y,m as P,f as R,n as I,j as e,h as E,B as a,o as F,_ as h,p as U,q as _,l as M,L as V,e as Y,E as H}from"./index-e-UFtOUC.js";import{F as O}from"./index-DqVozGo8.js";import{T as q,a as B,b as D,c as o,d as Q,e as r}from"./table-CQZEcfDi.js";import{A as $,a as G,b as J,c as K,d as W,e as X,f as Z,g as ee}from"./alert-dialog-CEOMNaNZ.js";import{S as se,a as te,b as ae,c as ie,d as k}from"./select-tKmmqQ5T.js";import{I as le}from"./input-DxTUsu_w.js";import{H as ne}from"./index-rHkD9Ve4.js";import{c as L,a as re,b as oe}from"./Codes-UzHbhsRF.js";import{P as de,a as ce,b as T}from"./popover-qKfd6OnR.js";import{L as me}from"./loader-circle-DhH9yg-p.js";import"./index-CJ8OMbQp.js";import"./Combination-BgG73cBh.js";import"./index-ciowWXAl.js";import"./floating-ui.react-dom-YN4Fy7vO.js";import"./createLucideIcon-ljYiYlmp.js";function ue({data:l}){const[t,g]=z(),[b,p]=y.useState(!1),[m,j]=y.useState(""),N=P(),u=R(),[n,C]=y.useState(l),f=(s,i)=>{const w={...Object.fromEntries(t.entries()),[s]:i};g(w)};y.useEffect(()=>{(()=>{const i=t.get("type"),c=t.get("value");if(!i&&!c){C(l);return}const w=l==null?void 0:l.filter(x=>{if(!i&&c)return x.title.toLowerCase().includes(c.toLowerCase());if(!c&&i)return i==="all"?x:i.toLowerCase()===x.type_of.toLowerCase();if(c&&i)return i.toLowerCase()===x.type_of.toLowerCase()&&x.title.toLowerCase().includes(c.toLowerCase())});C(w)})()},[t,l]);const d=s=>{u(`/app/campaigns/${s}`)},{mutateAsync:S,isPending:v}=I(),A=s=>{const i=h.loading("Deleting Campaign");S(s).then(()=>{h.success("Campaign deleted successfully",{id:i}),N.invalidateQueries()}).catch(()=>{h.error("Unable to delete campaign",{id:i})})};return e.jsxs("div",{children:[e.jsxs("div",{className:"w-full flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"basis-1/4 flex items-center gap-2",children:[e.jsx("p",{className:"text-sm",children:"Filter by:"}),e.jsxs(se,{onValueChange:s=>f("type",s),children:[e.jsx(te,{className:"w-[150px]",children:e.jsx(ae,{placeholder:t.get("type")==="direct"?"Direct":t.get("type")==="upload"?"Upload":"All Types"})}),e.jsxs(ie,{children:[e.jsx(k,{value:"all",children:"All Types"}),e.jsx(k,{value:"direct",children:"Direct"}),e.jsx(k,{value:"upload",children:"Upload"})]})]})]}),e.jsx(le,{type:"text",placeholder:"Search by campaign title...",className:"max-w-[300px]",defaultValue:t.get("value")||"",onChange:s=>f("value",s.target.value)}),e.jsx("div",{className:"basis-1/4 flex items-center justify-end gap-2"})]}),e.jsxs(q,{children:[e.jsx(B,{children:e.jsxs(D,{children:[e.jsx(o,{children:"ID"}),e.jsx(o,{className:"min-w-[200px]",children:"Title"}),e.jsx(o,{children:"Leads"}),e.jsx(o,{className:"min-w-[200px]",children:"Created At"}),e.jsx(o,{children:"Type"}),e.jsx(o,{children:"Contacted"}),e.jsx(o,{children:"Converted"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(Q,{children:(n==null?void 0:n.length)>0?n==null?void 0:n.map(s=>e.jsxs(D,{children:[e.jsx(r,{onClick:()=>d(s.id),children:s.id}),e.jsx(r,{onClick:()=>d(s.id),children:s.title}),e.jsx(r,{onClick:()=>d(s.id),children:s.leads}),e.jsx(r,{onClick:()=>d(s.id),children:E(s.created).format("MMM DD, YYYY hh:mm")}),e.jsx(r,{onClick:()=>d(s.id),children:s.type_of}),e.jsx(r,{onClick:()=>d(s.id),children:s.contacted_leads}),e.jsx(r,{onClick:()=>d(s.id),children:s.converted_leads}),e.jsx(r,{children:e.jsxs(de,{children:[e.jsx(ce,{children:e.jsx(a,{size:"sm",variant:"ghost",className:"my-2",children:e.jsx(ne,{})})}),s.type_of.toLowerCase()==="upload"?e.jsxs(T,{className:"flex flex-col gap-3 w-max",children:[e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>F(s.id),children:"Launch Campaign"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>L(s.id),children:"Copy URL"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded border-destructive text-destructive hover:bg-destructive hover:text-white",disabled:v,onClick:()=>{j(s.id),p(!0)},children:"Reset Campaign"}),e.jsx(a,{variant:"destructive",size:"sm",className:"rounded",disabled:v,onClick:()=>A(s.id),children:"Delete Campaign"})," "]}):e.jsxs(T,{className:"flex flex-col gap-3 w-max",children:[e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>re(s.id),children:"Copy code as popup"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>oe(s.id),children:"Copy code inline form"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>L(s.id),children:"Copy URL"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>{u(`/campaigns/form/edit/${s.id}`)},children:"Edit Form"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded",onClick:()=>{u(`/campaigns/edit/${s.id}`)},children:"Edit Context"}),e.jsx(a,{variant:"outline",size:"sm",className:"rounded border-destructive text-destructive hover:bg-destructive hover:text-white",disabled:v,onClick:()=>{j(s.id),p(!0)},children:"Reset Campaign"}),e.jsx(a,{variant:"destructive",size:"sm",className:"rounded",disabled:v,onClick:()=>A(s.id),children:"Delete Campaign"})]})]})})]},s.id)):e.jsx(D,{className:"hover:bg-transparent",children:e.jsx(r,{colSpan:8,className:"text-center h-[300px]",children:"Your filter did not return any lead!"})})})]}),e.jsx(xe,{open:b,setIsOpen:p,id:m,setCurrentId:j})]})}const xe=({open:l,setIsOpen:t,id:g,setCurrentId:b})=>{const{mutateAsync:p,isPending:m}=U(),j=N=>{if(N.preventDefault(),!g)return;const u=h.loading("Resetting campaign data",{id:"resetToast"});p(g).then(()=>{h.success("Campaign data reset successfully",{id:u})}).catch(n=>{var C,f;h.error(((f=(C=n==null?void 0:n.response)==null?void 0:C.data)==null?void 0:f.message)||"Unable to reset campaign data",{id:u})})};return e.jsx($,{open:l,onOpenChange:m?()=>{}:()=>{t(!1),b("")},children:e.jsxs(G,{children:[e.jsxs(J,{children:[e.jsx(K,{children:"Reset Campaign?"}),e.jsx(W,{className:"py-4",children:"This action cannot be undone. This will permanently delete all the leads in the campaign. Do you still wish to proceed?"})]}),e.jsxs(X,{children:[e.jsxs(Z,{className:"mr-2 bg-destructive text-white hover:bg-destructive/90",onClick:j,disabled:m,children:[m&&e.jsx(me,{className:"animate-spin"}),"Yes, Reset Campaign"]}),e.jsx(ee,{disabled:m,children:"No, Cancel"})]})]})})};function Te(){const{isLoading:l,data:t}=_();return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Campaigns",subtitle:"All your campaigns in one place",button:e.jsx(V,{to:"/campaigns/new",children:e.jsxs(a,{className:"pry-btn gap-1",children:[e.jsx(O,{})," Add New Campaign"]})})}),e.jsx("div",{className:"p-4 rounded-2xl bg-white",children:l?e.jsx("div",{className:"w-full h-[300px] flex items-center justify-center",children:e.jsx(Y,{})}):(t==null?void 0:t.length)>0?e.jsx(ue,{data:t}):e.jsx(H,{})})]})}export{Te as default};
