import{r as u,j as t,B as b,_ as i,V as v,W as S,z as y,J as _,X as I}from"./index-ger-BTh1.js";import{A as N,a as D,b as V,c as L,e as E}from"./alert-dialog-Bd8tORSW.js";import{I as T}from"./input-CLrwAzp3.js";import{C as g}from"./Card-CKLdaNGG.js";import{C as $}from"./CampaignTable-CvjtoTIo.js";import"./index-tJc6JJqt.js";import"./Combination-CBJd--lk.js";import"./table-BERZKBKj.js";import"./index-D20Vd7-a.js";import"./index-BhCnLhxT.js";function q({modalActive:m,setModalActive:l,setCampaigns:x,campaign_id:n}){const[e,d]=u.useState(!1),h=async c=>{d(!0),c.preventDefault();const j=c.target,r=Object.fromEntries(new FormData(j)).access_code,a=i.loading("Verifying access code...");await v.get(`${S}/dashboard/${n}/${r}`).then(s=>{i.success("Access code verified",{id:a}),x(s.data),sessionStorage.setItem("guestVerified","true"),sessionStorage.setItem("access_code",JSON.stringify(r)),l(!1)}).catch(s=>{if(s.response.status&&s.response.status===401)return i.error("Access denied. Access code invalid",{id:a});i.error("Something went wrong",{id:a}),console.log(s)}).finally(()=>d(!1))};return t.jsx(N,{open:m,children:t.jsxs(D,{className:"max-w-lg",children:[t.jsx(V,{children:t.jsx(L,{className:"text-xl font-semibold",children:"Enter Access Code"})}),t.jsx(E,{children:"An access code was sent with the invite mail. Enter it to gain access to view this campaign"}),t.jsxs("form",{onSubmit:h,className:"flex items-center gap-2",children:[t.jsx(T,{type:"text",placeholder:"access code",name:"access_code",required:!0}),t.jsx(b,{type:"submit",className:"pry-btn",disabled:e,children:"View Campaign"})]})]})})}function P(){var w,A,C,p;const m=sessionStorage.getItem("guestVerified"),{campaign_id:l}=y(),[x,n]=u.useState(()=>!m),[e,d]=u.useState([]),[h,c]=u.useState(!1),j=async()=>{c(!0);const o=sessionStorage.getItem("access_code");if(!o)return n(!0);await v.get(`${S}/dashboard/${l}/${JSON.parse(o)}`).then(f=>{d(f.data),sessionStorage.setItem("guestVerified","true")}).catch(f=>{if(n(!0),f.response.status&&f.response.status===401)return i.error("Access denied. Access code invalid");i.error("Something went wrong")}).finally(()=>{c(!1)})};u.useEffect(()=>{sessionStorage.getItem("guestVerified")&&j()},[]);const r=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(o=>o.status.toLowerCase()==="contacted")),a=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(o=>o.contacted_status.toLowerCase()==="converted")),s=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(o=>o.contacted_status.toLowerCase()==="rejected"));return t.jsxs(t.Fragment,{children:[t.jsx(q,{modalActive:x,setModalActive:n,setCampaigns:d,campaign_id:l}),t.jsxs("div",{className:"px-[4vw] pb-10",children:[t.jsx(_,{}),h?t.jsx(I,{}):(e==null?void 0:e.leads)&&t.jsxs("div",{className:"mt-10",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[t.jsx(g,{title:"Total Leads",qty:((w=e==null?void 0:e.leads)==null?void 0:w.length)||0}),t.jsx(g,{title:"Total Called",qty:(r==null?void 0:r.length)||0,total:((A=e==null?void 0:e.leads)==null?void 0:A.length)||0}),t.jsx(g,{title:"Total Qualified",qty:(a==null?void 0:a.length)||0,total:((C=e==null?void 0:e.leads)==null?void 0:C.length)||0}),t.jsx(g,{title:"Total Rejected",qty:(s==null?void 0:s.length)||0,total:((p=e==null?void 0:e.leads)==null?void 0:p.length)||0})]}),t.jsx("div",{className:"p-4 rounded-2xl bg-white",children:t.jsx($,{guest:!0,campaign_id:l??"",data:e==null?void 0:e.leads,campaign_name:e==null?void 0:e.campaign_name})})]})]})]})}export{P as default};
