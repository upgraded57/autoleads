import{r as g,j as t,_ as i,c as A}from"./index-BamLPRPK.js";import{L as w}from"./Logo-DiR7EHDd.js";import{a as p,b as j}from"./baseUrl-HwsEoYQ5.js";import{A as C,a as b,b as v,c as y,e as S}from"./alert-dialog-CRD110N2.js";import{B as _}from"./button-9-gbE7ke.js";import{I}from"./input-uqjX1zVl.js";import{C as f,a as N}from"./CampaignTable-BVPYl0TR.js";import"./logo-alt-DamHNGlx.js";import"./index-BMbkxJE0.js";import"./Combination-DvYHqWDa.js";import"./table-BMKN6FD4.js";import"./index-Vkln46tf.js";import"./iconBase-1Fq5GbpP.js";import"./index-CjYiw0k1.js";import"./axiosInstance-D6jcOrH_.js";function D({modalActive:x,setModalActive:c,setCampaigns:u,campaign_id:n}){const[e,d]=g.useState(!1),h=async o=>{d(!0),o.preventDefault();const l=o.target,r=Object.fromEntries(new FormData(l)).access_code,a=i.loading("Verifying access code...");await p.get(`${j}/dashboard/${n}/${r}`).then(s=>{i.success("Access code verified",{id:a}),u(s.data),sessionStorage.setItem("guestVerified","true"),sessionStorage.setItem("access_code",JSON.stringify(r)),c(!1)}).catch(s=>{if(s.response.status&&s.response.status===401)return i.error("Access denied. Access code invalid",{id:a});i.error("Something went wrong",{id:a}),console.log(s)}).finally(()=>d(!1))};return t.jsx(C,{open:x,children:t.jsxs(b,{className:"max-w-lg",children:[t.jsx(v,{children:t.jsx(y,{className:"text-xl font-semibold",children:"Enter Access Code"})}),t.jsx(S,{children:"An access code was sent with the invite mail. Enter it to gain access to view this campaign"}),t.jsxs("form",{onSubmit:h,className:"flex items-center gap-2",children:[t.jsx(I,{type:"text",placeholder:"access code",name:"access_code",required:!0}),t.jsx(_,{type:"submit",className:"pry-btn",disabled:e,children:"View Campaign"})]})]})})}function Q(){var a;const x=sessionStorage.getItem("guestVerified"),{campaign_id:c}=A(),[u,n]=g.useState(()=>!x),[e,d]=g.useState([]),h=async()=>{const s=sessionStorage.getItem("access_code");if(!s)return n(!0);await p.get(`${j}/dashboard/${c}/${JSON.parse(s)}`).then(m=>{d(m.data),sessionStorage.setItem("guestVerified","true")}).catch(m=>{if(n(!0),m.response.status&&m.response.status===401)return i.error("Access denied. Access code invalid");i.error("Something went wrong")})};g.useEffect(()=>{sessionStorage.getItem("guestVerified")&&h()},[]);const o=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(s=>s.status.toLowerCase()==="contacted")),l=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(s=>s.contacted_status.toLowerCase()==="converted")),r=(e==null?void 0:e.leads)&&(e==null?void 0:e.leads.filter(s=>s.contacted_status.toLowerCase()==="rejected"));return t.jsxs(t.Fragment,{children:[u&&t.jsx(D,{modalActive:u,setModalActive:n,setCampaigns:d,campaign_id:c}),t.jsx(w,{}),(e==null?void 0:e.leads)&&t.jsxs("div",{className:"px-5",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[t.jsx(f,{title:"Total Leads",qty:((a=e==null?void 0:e.leads)==null?void 0:a.length)||0}),t.jsx(f,{title:"Total Called",qty:(o==null?void 0:o.length)||0}),t.jsx(f,{title:"Total Qualified",qty:(l==null?void 0:l.length)||0}),t.jsx(f,{title:"Total Rejected",qty:(r==null?void 0:r.length)||0})]}),t.jsx("div",{className:"p-4 rounded-2xl bg-white",children:t.jsx(N,{campaign_id:c??"",data:e==null?void 0:e.leads,campaign_name:e==null?void 0:e.campaign_name})})]})]})}export{Q as default};
